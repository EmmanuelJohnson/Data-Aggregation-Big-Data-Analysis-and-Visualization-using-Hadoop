The workplace shooting in a Chicago suburb last week that left five people dead exposed the failings of the system designed to keep guns away from convicted felons and others deemed too dangerous to handle firearms.Federal law bars gun ownership by felons, fugitives, drug abusers, people adjudicated to be mentally ill, those dishonorably discharged from the military or living in the country illegally, and by convicted domestic abusers or others subject to domestic violence restraining orders. But experts say the number of people who are barred from owning guns but have them anyway may reach into the millions.Still, only eight states have laws that provide an explicit mechanism so that people suspected of having guns in violation of those prohibitions are actually required to give them up. And some of those states merely allow — but do not require — the police to seek a court order to confiscate such guns.That was the case in Illinois, where the authorities knew for more than four years that Gary Martin was a violent felon but apparently did nothing to ensure that he surrendered the laser-sighted Smith & Wesson handgun that he used to kill five co-workers in Aurora, Ill., on Friday.The authorities say they are investigating how Mr. Martin slipped through the cracks of the Illinois law, which the police might have been able to use to confiscate his handgun years ago. And the Illinois State Police said they were reviewing why an initial background check failed to turn up a criminal conviction that should have blocked him from buying the gun to begin with.[Read more about the Aurora shooting here.]Across the nation, these problems keep coming to light: A man who killed 26 people at a Texas church in 2017 passed a background check to get a weapon despite a military conviction for domestic assault that should have barred him from having guns.A man who killed nine people at a South Carolina church in 2015 bought his gun after a background check failed to immediately reveal that he had admitted possessing a controlled substance.Last year, a man killed four people at a Waffle House restaurant in Tennessee using an assault weapon that he had been required to give up under the Illinois law just eight months before.Unlike Illinois, most states do not have an explicit process allowing the police a way to confiscate guns from people suspected of being prohibited owners. But even in those states that do, two factors explain why many police and sheriff’s departments use these laws so infrequently: time and danger.“That’s a challenging situation for law enforcement to knock on a door and say, ‘Hey, we’re here to take your guns, Mr. Dangerous Criminal,’” said Adam Skaggs, chief counsel of the Giffords Law Center to Prevent Gun Violence, which advocates tighter gun laws.Only a single state — California — has a database dedicated to tracking firearm owners who have lost their right to possess a gun, either because of a new criminal conviction or something else. The program, which was created in 2001 and went online five years later, was sponsored by the Republican leader in the State Senate and was approved with strong bipartisan support.Agents from the California Department of Justice work with local law enforcement officials to surveil and disarm people in the database believed to illegally own firearms.“They’re like little SWAT teams,” said Mark Leno, a former California state senator who sponsored a $24 million special appropriation in 2013 to hire 36 more state agents and reduce a backlog of suspected illegal gun owners.“It is very labor intensive to do this right, and there is always the risk that someone, especially if they are suffering from a serious mental illness, could become very frightened and might act out,” said Mr. Leno, a Democrat from San Francisco.Prompting state lawmakers to approve the funding were cases like that of Roy Perez, a mentally ill man who had been in the California database for three years when he shot and killed his mother, his neighbor, and his neighbor’s 4-year-old daughter in Baldwin Park in 2008. He was scheduled to have his gun confiscated when the killings occurred, but agents did not get to him in time.Since then, the program has shown results: In the past five years, California has cut by half, to about 10,000, the backlog of people in the database believed to own firearms illegally, even though nearly 41,000 names were added over that time. In 2017 alone, the program seized almost 4,000 guns.Thousands also obtain guns every year because of a loophole that allows gun dealers to sell firearms to people whose background checks have not been completed after three business days. In 2017, guns were sold to at least 4,864 people who were later flagged in the system after their background checks took longer than three days.Aside from California, only Connecticut and Nevada expressly require felons to provide proof to courts or to law enforcement that they have turned over guns after conviction, according to the Giffords Law Center. Illinois and four other states — Hawaii, Massachusetts, New York and Pennsylvania — also provide statutory mechanisms for felons to turn over illegally possessed weapons, though the procedures are not as stringent.But when Illinois lawmakers sought to tighten state law so that the police would be mandated to confiscate guns owned by people barred from possessing them, or at least verify that the guns had been transferred to legal owners, concerns about manpower helped doom the proposal.“Law enforcement didn’t object to the essence of the law,” but said they would need far more money to carry it out, said State Representative Kathleen Willis, a Democrat from suburban Chicago who is pushing to toughen the law.A handful of other states also require people convicted of domestic abuse or subject to restraining orders to give up weapons. Some states also allow a judge to temporarily take firearms from those deemed a threat to themselves or others.Strengthening — but not expanding — the existing background check system is one of the few gun-related issues that have had bipartisan support. Last year, Senator John Cornyn, Republican of Texas, sponsored a bill to make sure more records of felony and domestic abuse convictions were fed into the system.“For years agencies and states haven’t complied with the law, failing to upload these critical records without consequence,” Mr. Cornyn said before the bill became law. “Just one record that’s not properly reported can lead to tragedy.”In Mr. Martin’s case, he was issued a state firearm owner’s card in January 2014 — and five weeks later he passed a background check to buy his handgun — even though he had been convicted of aggravated assault for stabbing a former girlfriend with a knife and hitting her with a baseball bat in Mississippi in 1995.The Illinois State Police said Mr. Martin, who died in a shootout with officers on Friday, lied on his firearm owner’s card application about whether he had any felony convictions. They also indicated that the conviction only surfaced during a separate request for a concealed-carry permit a few months later because his fingerprints were submitted as part of that application.According to the State Police, 10,818 people had Illinois firearm owner’s cards revoked last year. But in most cases they failed — as Mr. Martin did in 2014 — to turn in required paperwork stating how they disposed of any weapons.And those numbers may represent only a fraction of the felons and others across the country who are barred from gun ownership but who possess them anyway.One in five gun purchases is estimated to occur with no background check, such as through sales over the internet or at gun shows, said Kris Brown, president of the Brady Center to Prevent Gun Violence. That attracts buyers who would fail a check.“You’d have to assume that if you are a prohibited purchaser, you are aware of that loophole, and that’s how you’re going to get a gun,” Ms. Brown said.While no one knows for sure how many of the country’s 20 million people with felony records illegally possess guns, by some estimates three in 10 of all American adults own firearms.Mr. Skaggs noted that Congress is now debating a proposal to eliminate loopholes allowing some purchases without a background check.A root cause of tragedies like Friday’s shooting, he added, is that people prohibited from owning firearms were able to obtain them to begin with.“If they hadn’t been allowed to get the guns in the first place, we wouldn’t be talking about having to get someone to get the guns away from them,” he said.